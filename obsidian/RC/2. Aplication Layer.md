#### Addressing Processes

Para receber mensagens um processo tem que ter um _identifier_.
Host tem um _32-bit IPv4_ e/ou _128-bit IPv6_ .
Este Host IP não é suficiente para identificar a a aplicação em progresso já que muitas podem estar a ocorrer nele então nem tanto um _IP address_ como uma _Port number_.

#### Aplication Layer Protocol

Define:

- Tipos de mensagens exchange. (request, response)
- Message syntax (em que campo existe e quais os limites)
- Message semantics (meaning of information)
- Regras para quando a aplicação deve receber e responder a mensagens

__Public-domain protocols__: definido em RFCs, permite _interoperability_. (http)
__Proprietary protocols__: skype.

### Aplication Layer uses Transport Layer Services

O que Transport Layer requer:

- __Data Integrity__: Some apps can tolerate loss. Others require 100% reliable data transfer.
- __Throughput__: Algumas apps precisam de um mínimo de throughput para serem "efetivas". Outras não se importam com isso sequer.
- __Security__: Encryption, integridade da data. (não podem ser alterados)
- __Timing__: algumas apps requerem low delay para serem "efetivas".

# Transport Layer Services

###### TCP Service:

- Connection-oriented.
- Reliable transport entre mandar e receber processos.
- Flow Control: Sender não saturar o receiver.
- _Does not Provide_: timing, minimum throughtput guarantees, security.

###### UDP Service:

- Unreliable data transfer entre mandar e receber.
- _Does not provide_: connection setup, reliability, flow control, congestion control, timing, throughput e segurança.

##### Transport Layer Security (TLS)
Promete TCP connections encriptadas. Integridade da data e end-point authentication.

#### Arquitetura Cliente-Servidor
_Servidor_ : Sempre ligado com endereço de IP permanente e escalável com server farms.
_Clientes_ : Comunicam com o servidor, não é necessário estarem sempre conectados. Podem usar IPs dinâmicos e não comunicam diretamente com eles.

#### Arquitetura Peer-to-peer
Não há servidor sempre ligado, peers comunicam diretamente entre si. Pode mudar de IP. Muito escalável mas muito difícil de gerir.

#### Híbrido
Como o Skype. Servidor dá aos clientes os endereços mas as chamadas são feitas diretamente entre os clientes usando Voice-over-IP P2P.

### API de Sockets
Um processo envia ou recebe mensagens a partir do seu socket. A API permite escolher o protocolo de transporte e definir alguns parâmetros.

## Socket Programming using TCP

Client tem que contactar o server:

- Processo do server tem que estar a correr.
- Server tem que ter criado um socket para receber os contatos do cliente.

Cliente contata server por:

- Cria local TCP socket.
- Especifica IP address, porta.

Quando cliente cria socket: estabelece conexão com server TCP.

Quando contactado pelo cliente, o server TCP crai novo socket para comunicações entre cliente e server.
Permite comunicar com multiplos clientes. Portas diferentes para clientes diferentes.

TCP _provides_ reliablle, in-order transfer of bytes entre o cliente e servidor.

## Socket Programming with UDP

UDP não estabelece conexão entre o cliente e servidor.

Sender explicita qual é o IP e a porta. Server extrata essas infos.

UDP ou recebe ou perde.

UDP _provides_ unreliable transfer of groups of bytes entre cliente e server.

# TCP vs UDP

#### TCP

- `read() write()` .
- Byte stream ( sem perdas de bytes).
- Bytes lidos no read() são todos os mandados pelo write().
- Bytes escritos pelo write() podem ter que ser lidos várias vezes pelo read().

#### UDP

- `sendto() recvfrom()`
- Preserve boundaries entre mensagens.
- Cada mensagem lida com recvfrom() corresponde a uma única sendto().
- Mensagem pode ser perdida.

### WWW

___HTTP___ - HyperText Transport Protocol. Protocolo usado para transferir WEB pages.

HTTP usa TCP como transport layer (default: porta 80).
Cliente: browser faz pedidos, receve e apresenta respostas.
Server: responde a pedidos.

É _stateless_ (não guarda informação acerca de pedidos anteriores).

Ciclo:

1. Cliente inicia TCP connection (cria socket) ao server na porta 80.
2. Server aceita TCP.
3. HTTP messages entre HTTP cliente e HTTP server.
4. TCP connection fecha.

___HTTP Object___: identificado por um URL.
##### Non-persistent HTTP
Pelo menos um objeto é mandado pela conexão TCP.
Browser pode abrir conexões paralelas.
HTTP/1.0.

___RTT (round trip time)___: tempo para um pequeno pacote viajar até ao cliente e voltar.
###### Tempo de resposta:
Um RTT para inicializar a conexão TCP.
UM RTT par um HTTP request e alguns primeiros bytes da resposta HTTP.
Tempo de transmissão do file.

``TOTAL = 2 x RTT + transmit time``
##### Persistent HTTP
Multiples objets podem ser mandados por uma só TCP connection entre cliente e servidor.
Com pipelining o broser pode mandar requests assim que os identificar.
HTTP/1.1.






